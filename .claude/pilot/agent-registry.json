{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "version": "1.1",
  "description": "Agent registry for Pilot AGI orchestration with task decomposition support",

  "agents": {
    "frontend": {
      "name": "Frontend Agent",
      "description": "React/Next.js UI development specialist",
      "rules_file": ".claude/pilot/rules/frontend.yaml",
      "capabilities": [
        "component_creation",
        "styling",
        "accessibility",
        "responsive_design",
        "state_management",
        "data_fetching_ui"
      ],
      "file_patterns": [
        "**/*.tsx",
        "**/*.jsx",
        "**/components/**/*",
        "**/app/**/*.tsx",
        "**/pages/**/*.tsx",
        "**/*.css",
        "**/*.scss",
        "**/styles/**/*"
      ],
      "task_indicators": [
        "component",
        "page",
        "ui",
        "button",
        "form",
        "modal",
        "layout",
        "responsive",
        "style",
        "css",
        "tailwind",
        "animation",
        "design system"
      ],
      "excluded_patterns": [
        "**/api/**/*",
        "**/server/**/*",
        "**/*.test.*",
        "**/*.spec.*"
      ],
      "model_preference": "opus",
      "memory": {
        "publishes": ["component-registry"],
        "consumes": ["design-tokens", "api-types"]
      },
      "decomposition": {
        "atomic_actions": [
          "create_component",
          "create_page",
          "create_layout",
          "add_styling",
          "add_animation",
          "implement_form",
          "add_state_management"
        ],
        "input_requirements": {
          "always": ["design_tokens", "existing_components"],
          "optional": ["api_types", "user_context"]
        },
        "output_format": {
          "files": ["react_component", "css_module", "config"],
          "data": ["component_exports", "prop_types"]
        },
        "typical_subtask_count": "1-3 per feature"
      }
    },

    "backend": {
      "name": "Backend Agent",
      "description": "Node.js/Next.js API and server-side specialist",
      "rules_file": ".claude/pilot/rules/backend.yaml",
      "capabilities": [
        "api_design",
        "database_operations",
        "authentication",
        "authorization",
        "input_validation",
        "server_actions"
      ],
      "file_patterns": [
        "**/api/**/*",
        "**/server/**/*",
        "**/lib/**/*",
        "**/services/**/*",
        "**/db/**/*",
        "**/prisma/**/*",
        "**/*.server.ts"
      ],
      "task_indicators": [
        "api",
        "endpoint",
        "database",
        "query",
        "mutation",
        "server action",
        "authentication",
        "authorization",
        "middleware",
        "prisma",
        "schema"
      ],
      "excluded_patterns": [
        "**/components/**/*",
        "**/*.test.*",
        "**/*.spec.*"
      ],
      "model_preference": "opus",
      "memory": {
        "publishes": ["api-types"],
        "consumes": ["component-registry"]
      },
      "decomposition": {
        "atomic_actions": [
          "create_api_route",
          "create_server_action",
          "update_schema",
          "create_service",
          "add_middleware",
          "implement_auth"
        ],
        "input_requirements": {
          "always": ["database_schema", "existing_api_patterns"],
          "optional": ["frontend_types", "auth_context"]
        },
        "output_format": {
          "files": ["api_route", "server_action", "schema", "service"],
          "data": ["api_types", "endpoint_contracts", "schema_changes"]
        },
        "typical_subtask_count": "1-2 per endpoint"
      }
    },

    "testing": {
      "name": "Testing Agent",
      "description": "Unit, integration, and E2E testing specialist",
      "rules_file": null,
      "capabilities": [
        "unit_testing",
        "integration_testing",
        "e2e_testing",
        "test_coverage",
        "mocking"
      ],
      "file_patterns": [
        "**/*.test.ts",
        "**/*.test.tsx",
        "**/*.spec.ts",
        "**/*.spec.tsx",
        "**/tests/**/*",
        "**/test/**/*",
        "**/__tests__/**/*",
        "**/e2e/**/*"
      ],
      "task_indicators": [
        "test",
        "testing",
        "unit test",
        "integration test",
        "e2e",
        "coverage",
        "vitest",
        "playwright",
        "mock",
        "fixture"
      ],
      "excluded_patterns": [],
      "model_preference": "sonnet",
      "memory": {
        "publishes": [],
        "consumes": ["api-types", "component-registry"]
      },
      "decomposition": {
        "atomic_actions": [
          "write_unit_tests",
          "write_integration_tests",
          "write_e2e_tests",
          "create_test_fixtures",
          "setup_mocks"
        ],
        "input_requirements": {
          "always": ["source_files_to_test"],
          "optional": ["existing_test_patterns", "api_contracts"]
        },
        "output_format": {
          "files": ["test_file", "fixture", "mock"],
          "data": ["coverage_report", "test_summary"]
        },
        "execution_order": "post_implementation",
        "typical_subtask_count": "1 per source file"
      }
    },

    "security": {
      "name": "Security Agent",
      "description": "Security review and vulnerability prevention specialist",
      "rules_file": ".claude/pilot/rules/security.yaml",
      "capabilities": [
        "security_audit",
        "vulnerability_detection",
        "input_sanitization",
        "authentication_review",
        "dependency_audit"
      ],
      "file_patterns": [
        "**/*"
      ],
      "task_indicators": [
        "security",
        "vulnerability",
        "auth",
        "permission",
        "xss",
        "injection",
        "encryption",
        "secrets",
        "audit",
        "owasp"
      ],
      "excluded_patterns": [
        "**/*.md",
        "**/*.json",
        "**/node_modules/**/*"
      ],
      "model_preference": "opus",
      "memory": {
        "publishes": [],
        "consumes": []
      },
      "decomposition": {
        "atomic_actions": [
          "audit_authentication",
          "audit_authorization",
          "audit_input_validation",
          "audit_dependencies",
          "check_secrets_exposure"
        ],
        "input_requirements": {
          "always": ["source_code", "security_rules"],
          "optional": ["dependency_manifest", "env_config"]
        },
        "output_format": {
          "files": [],
          "data": ["vulnerability_report", "recommendations", "severity_scores"]
        },
        "execution_order": "post_implementation",
        "typical_subtask_count": "1 per security domain"
      }
    },

    "review": {
      "name": "Review Agent",
      "description": "Code review and quality assurance specialist",
      "rules_file": ".claude/pilot/rules/review.yaml",
      "capabilities": [
        "code_review",
        "quality_check",
        "pattern_compliance",
        "performance_review",
        "documentation_review"
      ],
      "file_patterns": [
        "**/*"
      ],
      "task_indicators": [
        "review",
        "quality",
        "refactor",
        "cleanup",
        "optimize",
        "improve",
        "code smell",
        "lint",
        "pr review"
      ],
      "excluded_patterns": [
        "**/node_modules/**/*",
        "**/*.lock"
      ],
      "model_preference": "sonnet",
      "memory": {
        "publishes": [],
        "consumes": ["design-tokens"]
      },
      "decomposition": {
        "atomic_actions": [
          "review_code_quality",
          "review_patterns",
          "review_performance",
          "review_documentation",
          "check_file_sizes"
        ],
        "input_requirements": {
          "always": ["files_to_review", "review_rules"],
          "optional": ["existing_patterns", "performance_baseline"]
        },
        "output_format": {
          "files": [],
          "data": ["issues_found", "recommendations", "approval_status"]
        },
        "execution_order": "post_implementation",
        "typical_subtask_count": "1 per review domain"
      }
    }
  },

  "routing": {
    "rules": [
      {
        "condition": "file_pattern_match",
        "description": "Route based on file patterns being modified"
      },
      {
        "condition": "task_indicator_match",
        "description": "Route based on keywords in task description"
      },
      {
        "condition": "explicit_agent",
        "description": "Route to explicitly requested agent"
      }
    ],
    "fallback": "review",
    "multi_agent_threshold": 0.5,
    "confidence_threshold": 0.7
  },

  "orchestration": {
    "patterns": {
      "full_stack_feature": {
        "description": "New feature touching frontend and backend",
        "agents": ["backend", "frontend"],
        "sequence": "parallel",
        "post_agents": ["testing", "review"]
      },
      "api_only": {
        "description": "Backend-only API work",
        "agents": ["backend"],
        "sequence": "single",
        "post_agents": ["security", "testing"]
      },
      "ui_only": {
        "description": "Frontend-only UI work",
        "agents": ["frontend"],
        "sequence": "single",
        "post_agents": ["testing"]
      },
      "security_audit": {
        "description": "Security-focused review",
        "agents": ["security"],
        "sequence": "single",
        "post_agents": ["review"]
      },
      "comprehensive": {
        "description": "Full review with all agents",
        "agents": ["frontend", "backend", "security"],
        "sequence": "parallel",
        "post_agents": ["testing", "review"]
      }
    }
  },

  "decomposition": {
    "enabled": true,
    "schemas": {
      "subtask": ".claude/pilot/schemas/subtask.yaml",
      "output": ".claude/pilot/schemas/subtask-output.yaml"
    },
    "thresholds": {
      "min_subtasks_for_decomposition": 3,
      "max_subtasks_per_task": 10,
      "max_parallel_subtasks": 4
    },
    "wave_execution": {
      "description": "Execute subtasks in waves based on dependency graph",
      "strategy": "parallel_within_wave",
      "error_handling": "continue_on_non_critical"
    },
    "data_passing": {
      "format": "DATA_OUTPUT blocks in agent response",
      "storage": "orchestrator_context",
      "validation": "schema_based"
    },
    "complexity_hints": {
      "simple": {
        "description": "Single domain, 1-2 files",
        "decompose": false,
        "example": "Add loading spinner to button"
      },
      "moderate": {
        "description": "Single domain, 3-5 files or cross-domain with clear boundary",
        "decompose": "optional",
        "example": "Create new form component with validation"
      },
      "complex": {
        "description": "Multi-domain, 5+ files, dependencies between deliverables",
        "decompose": true,
        "example": "Build user profile with avatar upload and settings"
      }
    }
  }
}
